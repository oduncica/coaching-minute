<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coaching Minute</title>
    <link rel="icon" type="image/x-icon" href="src/assets/favicon.ico" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@1,900&family=Open+Sans:wght@600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="index.css" />
  </head>

  <body>
    <section id="accueil">
      <div class="top-bar">
        <img
          src="src/assets/logo.png"
          alt="Logo Coaching Minute"
          class="logo"
        />
      </div>

      <h2 class="bienvenue" id="titre-principal">Bienvenue</h2>

      <p class="intro">
        Entrez votre requête ci-dessous et cliquez sur "Générer" pour obtenir
        une réponse de notre IA.
      </p>
    </section>

    <section id="formulaire">
      <div class="form-container">
        <label for="user-input">Votre requête :</label>
        <textarea
          id="user-input"
          placeholder="Entrez votre requête ici..."
          rows="5"
          style="width: 100%"
        ></textarea>
        <button id="generate-btn" class="btn">Générer</button>
      </div>
      <div id="response-container" style="margin-top: 20px">
        <h3>Réponse :</h3>
        <p id="response-text"></p>
      </div>
    </section>

    <script>
      document
        .getElementById("generate-btn")
        .addEventListener("click", async () => {
          const userInput = document.getElementById("user-input").value.trim();
          const responseText = document.getElementById("response-text");

          if (!userInput) {
            responseText.textContent = "Veuillez entrer une requête.";
            return;
          }

          responseText.textContent = "Génération en cours...";

          try {
            const response = await fetch(
              "https://openrouter.ai/api/v1/chat/completions",
              {
                method: "POST",
                headers: {
                  Authorization:
                    "Bearer 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",
                  "Content-Type": "application/json",
                  // "HTTP-Referer": "https://votre-site.com", // Facultatif
                  // "X-Title": "Coaching Minute", // Facultatif
                },
                body: JSON.stringify({
                  model: "mistralai/mistral-small-3.1-24b-instruct:free",
                  messages: [
                    {
                      role: "user",
                      content: userInput,
                    },
                  ],
                }),
              }
            );

            const data = await response.json();

            if (
              data.choices &&
              data.choices[0] &&
              data.choices[0].message.content
            ) {
              responseText.textContent = data.choices[0].message.content;
            } else {
              responseText.textContent = "Aucune réponse générée.";
            }
          } catch (error) {
            responseText.textContent =
              "Erreur lors de la génération : " + error.message;
          }
        });
    </script>
  </body>
</html>
